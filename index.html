<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KOMPETISI ROKET AIR LABIABA INDONESIA</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 0;
            background-color: #f0f8ff;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        
        header {
            background: linear-gradient(to right, #1e3c72, #2a5298);
            color: white;
            padding: 25px;
            text-align: center;
        }
        
        h1 {
            margin: 0 0 20px 0;
            font-size: 2.2rem;
            letter-spacing: 1px;
        }
        
        .header-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .info-item {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }
        
        .info-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1rem;
            font-weight: bold;
        }
        
        .login-section {
            padding: 40px 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 70vh;
            background-color: #f5f9ff;
        }
        
        .login-box {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 450px;
            text-align: center;
        }
        
        .login-box h2 {
            margin-top: 0;
            color: #1e3c72;
            margin-bottom: 30px;
        }
        
        .login-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .login-btn {
            padding: 15px;
            background-color: #2a5298;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .login-btn:hover {
            background-color: #1e3c72;
            transform: translateY(-2px);
        }
        
        .login-btn i {
            font-size: 1.2rem;
        }
        
        .password-section {
            display: none;
            margin-top: 20px;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #1e3c72;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            border-color: #2a5298;
            outline: none;
        }
        
        .operator-panel, .viewer-panel {
            display: none;
            padding: 20px;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #2a5298;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            background-color: #2a5298;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn:hover {
            background-color: #1e3c72;
            transform: translateY(-2px);
        }
        
        .btn-danger {
            background-color: #d9534f;
        }
        
        .btn-danger:hover {
            background-color: #c9302c;
        }
        
        .btn-success {
            background-color: #5cb85c;
        }
        
        .btn-success:hover {
            background-color: #449d44;
        }
        
        .btn-warning {
            background-color: #f0ad4e;
        }
        
        .btn-warning:hover {
            background-color: #ec971f;
        }
        
        .btn-info {
            background-color: #5bc0de;
        }
        
        .btn-info:hover {
            background-color: #31b0d5;
        }
        
        .input-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .manual-input, .file-upload {
            background-color: #f9f9f9;
            padding: 25px;
            border-radius: 10px;
            border: 1px solid #ddd;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .manual-input h3, .file-upload h3 {
            margin-top: 0;
            color: #1e3c72;
            margin-bottom: 20px;
        }
        
        .event-config {
            background-color: #f0f8ff;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 2px solid #2a5298;
        }
        
        .event-config h3 {
            margin-top: 0;
            color: #1e3c72;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .event-config-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 10px;
            border: 1px solid #ddd;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #2a5298;
            color: white;
            position: sticky;
            top: 0;
            font-weight: 600;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        tr:hover {
            background-color: #f1f7ff;
        }
        
        .top-50 {
            background-color: #e8f4ff !important;
        }
        
        input[type="number"] {
            width: 100%;
            padding: 8px 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .ranking-1 {
            background-color: #fffacd !important;
            font-weight: bold;
        }
        
        .ranking-2 {
            background-color: #f0f0f0 !important;
        }
        
        .ranking-3 {
            background-color: #ffebcd !important;
        }
        
        .status-bar {
            padding: 12px 20px;
            background-color: #e6f2ff;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid #2a5298;
        }
        
        .logout-btn {
            background-color: #d9534f;
        }
        
        .logout-btn:hover {
            background-color: #c9302c;
        }
        
        .settings-section {
            background-color: #f9f9f9;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #ddd;
            display: none;
        }
        
        .settings-section h3 {
            margin-top: 0;
            color: #1e3c72;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .settings-form {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #eee;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }
        
        .settings-form h4 {
            margin-top: 0;
            color: #2a5298;
            margin-bottom: 15px;
        }
        
        .settings-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none;
        }
        
        .modal {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal h3 {
            margin-top: 0;
            color: #1e3c72;
            margin-bottom: 20px;
        }
        
        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            justify-content: flex-end;
        }
        
        .hidden {
            display: none !important;
        }
        
        .visible {
            display: block !important;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
            background-color: #f9f9f9;
        }
        
        .connection-status {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .connection-status.offline {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .connection-status .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #4caf50;
            animation: pulse 2s infinite;
        }
        
        .connection-status.offline .dot {
            background-color: #f44336;
            animation: none;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .viewer-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding: 10px 15px;
            background-color: #f0f8ff;
            border-radius: 8px;
            border-left: 4px solid #5bc0de;
        }
        
        @media (max-width: 768px) {
            .input-section {
                grid-template-columns: 1fr;
            }
            
            .panel-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .button-group {
                width: 100%;
                justify-content: flex-start;
            }
            
            .header-info {
                grid-template-columns: 1fr;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .event-config-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <!-- Font Awesome untuk ikon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header id="mainHeader">
            <h1>KOMPETISI ROKET AIR LABIABA INDONESIA</h1>
            <div class="header-info" id="headerInfo">
                <!-- Informasi event akan dimuat di sini -->
            </div>
        </header>
        
        <!-- Login Section -->
        <div class="login-section" id="loginSection">
            <div class="login-box">
                <h2><i class="fas fa-rocket"></i> Sistem Skoring Roket Air</h2>
                <p style="color: #666; margin-bottom: 30px;">Pilih mode untuk melanjutkan</p>
                
                <div class="login-options">
                    <button class="login-btn" id="operatorLoginBtn">
                        <i class="fas fa-user-cog"></i> Login sebagai Operator
                    </button>
                    <button class="login-btn" id="viewerLoginBtn">
                        <i class="fas fa-eye"></i> Masuk sebagai Viewer
                    </button>
                </div>
                
                <div class="password-section" id="passwordSection">
                    <div class="form-group">
                        <label for="password"><i class="fas fa-lock"></i> Password Operator</label>
                        <input type="password" id="password" placeholder="Masukkan password operator">
                    </div>
                    <button class="btn btn-success" id="submitPasswordBtn" style="width: 100%;">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <button class="btn" id="backToLoginBtn" style="width: 100%; margin-top: 10px;">
                        <i class="fas fa-arrow-left"></i> Kembali
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Operator Panel -->
        <div class="operator-panel" id="operatorPanel">
            <div class="panel-header">
                <h2><i class="fas fa-user-cog"></i> Panel Operator - Input Data Peserta</h2>
                <div class="button-group">
                    <button class="btn btn-warning" id="settingsBtn">
                        <i class="fas fa-cog"></i> Pengaturan
                    </button>
                    <button class="btn btn-info" id="eventConfigBtn">
                        <i class="fas fa-calendar-alt"></i> Konfigurasi Event
                    </button>
                    <button class="btn btn-danger" id="resetDataBtn">
                        <i class="fas fa-trash-alt"></i> Reset Data
                    </button>
                    <button class="btn logout-btn" id="logoutOperatorBtn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>
            
            <div class="status-bar">
                <div>
                    <strong>Total Peserta:</strong> <span id="totalPeserta">0</span> | 
                    <strong>Status:</strong> <span id="statusOperator">Operator aktif</span>
                </div>
                <div class="connection-status">
                    <span class="dot"></span> <span>Real-time Active</span>
                </div>
            </div>
            
            <!-- Konfigurasi Event -->
            <div class="event-config" id="eventConfigSection">
                <h3><i class="fas fa-calendar-alt"></i> Konfigurasi Event</h3>
                <div class="event-config-grid">
                    <div class="form-group">
                        <label for="tingkat">Tingkat Kompetisi</label>
                        <input type="text" id="tingkat" value="Regional/ Nasional 2026">
                    </div>
                    
                    <div class="form-group">
                        <label for="provinsi">Daerah / Provinsi</label>
                        <input type="text" id="provinsi" value="Jawa Tengah">
                    </div>
                    
                    <div class="form-group">
                        <label for="tanggal">Tanggal Pelaksanaan</label>
                        <input type="date" id="tanggal" value="2026-08-15">
                    </div>
                    
                    <div class="form-group">
                        <label for="lokasi">Tempat Pelaksanaan</label>
                        <input type="text" id="lokasi" value="Gelora Bung Karno, Jakarta">
                    </div>
                </div>
                <button class="btn btn-success" id="updateEventBtn" style="margin-top: 15px;">
                    <i class="fas fa-sync-alt"></i> Update Informasi Event
                </button>
            </div>
            
            <!-- Settings Section -->
            <div class="settings-section" id="settingsSection">
                <h3><i class="fas fa-cog"></i> Pengaturan Operator</h3>
                <div class="settings-grid">
                    <div class="settings-form">
                        <h4><i class="fas fa-key"></i> Ganti Password</h4>
                        <div class="form-group">
                            <label for="currentPassword">Password Saat Ini</label>
                            <input type="password" id="currentPassword">
                        </div>
                        <div class="form-group">
                            <label for="newPassword">Password Baru</label>
                            <input type="password" id="newPassword">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Konfirmasi Password Baru</label>
                            <input type="password" id="confirmPassword">
                        </div>
                        <div class="settings-buttons">
                            <button class="btn btn-success" id="savePasswordBtn">
                                <i class="fas fa-save"></i> Simpan Password
                            </button>
                            <button class="btn btn-danger" id="cancelPasswordBtn">
                                <i class="fas fa-times"></i> Batal
                            </button>
                        </div>
                    </div>
                    
                    <div class="settings-form">
                        <h4><i class="fas fa-download"></i> Ekspor Data</h4>
                        <p>Unduh data peserta dalam berbagai format:</p>
                        <div class="settings-buttons">
                            <button class="btn" id="exportExcelBtn">
                                <i class="fas fa-file-excel"></i> Export ke Excel
                            </button>
                            <button class="btn" id="exportPDFBtn">
                                <i class="fas fa-file-pdf"></i> Export ke PDF
                            </button>
                        </div>
                    </div>
                    
                    <div class="settings-form">
                        <h4><i class="fas fa-info-circle"></i> Informasi Sistem</h4>
                        <p><strong>Versi:</strong> 1.0.0</p>
                        <p><strong>Peserta Terdaftar:</strong> <span id="infoPesertaCount">0</span></p>
                        <p><strong>Kapasitas Maksimal:</strong> 500 peserta</p>
                        <p><strong>Terakhir Update:</strong> <span id="lastUpdate">-</span></p>
                    </div>
                </div>
            </div>
            
            <div class="input-section">
                <div class="manual-input">
                    <h3><i class="fas fa-edit"></i> Input Data Manual</h3>
                    <div class="form-group">
                        <label for="namaPeserta">Nama Peserta</label>
                        <input type="text" id="namaPeserta" placeholder="Masukkan nama peserta">
                    </div>
                    <div class="form-group">
                        <label for="nomorRoket">Nomor Roket / Peluncuran</label>
                        <input type="text" id="nomorRoket" placeholder="Misal: RKT-001">
                    </div>
                    <div class="form-group">
                        <label for="asalSekolah">Asal Sekolah</label>
                        <input type="text" id="asalSekolah" placeholder="Nama sekolah">
                    </div>
                    <div class="form-group">
                        <label for="daerahSekolah">Daerah Sekolah</label>
                        <input type="text" id="daerahSekolah" placeholder="Daerah asal sekolah">
                    </div>
                    <button class="btn btn-success" id="tambahPesertaBtn">
                        <i class="fas fa-plus"></i> Tambah Peserta
                    </button>
                </div>
                
                <div class="file-upload">
                    <h3><i class="fas fa-upload"></i> Upload Data dari Excel</h3>
                    <p>Format file Excel harus memiliki kolom: Nama, NoRoket, Sekolah, Daerah</p>
                    <div class="form-group">
                        <label for="excelFile">Pilih File Excel</label>
                        <input type="file" id="excelFile" accept=".xlsx, .xls">
                    </div>
                    <button class="btn btn-success" id="uploadExcelBtn">
                        <i class="fas fa-upload"></i> Upload Data
                    </button>
                    <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
                        <i class="fas fa-download"></i> Download template: 
                        <a href="#" id="downloadTemplate">template_data_peserta.xlsx</a>
                    </p>
                </div>
            </div>
            
            <div class="panel-header">
                <h2><i class="fas fa-list-ol"></i> Daftar Peserta (500 peserta maksimal)</h2>
                <div class="button-group">
                    <button class="btn" id="showSettingsBtn">
                        <i class="fas fa-cog"></i> Tampilkan Pengaturan
                    </button>
                    <button class="btn" id="hideSettingsBtn" style="display:none;">
                        <i class="fas fa-times"></i> Sembunyikan Pengaturan
                    </button>
                </div>
            </div>
            
            <div class="table-container">
                <table id="dataPeserta">
                    <thead>
                        <tr>
                            <th width="50">No</th>
                            <th width="120">Nomor Roket</th>
                            <th width="200">Nama Peserta</th>
                            <th width="250">Sekolah</th>
                            <th width="150">Daerah</th>
                            <th width="120">Peluncuran 1 (m)</th>
                            <th width="120">Peluncuran 2 (m)</th>
                            <th width="120">Skor Terbaik (m)</th>
                            <th width="80">Ranking</th>
                            <th width="100">Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="pesertaTableBody">
                        <!-- Data peserta akan dimuat di sini -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Viewer Panel -->
        <div class="viewer-panel" id="viewerPanel">
            <div class="panel-header">
                <h2><i class="fas fa-eye"></i> Hasil Kompetisi Roket Air - Tampilan Viewer</h2>
                <div class="button-group">
                    <button class="btn logout-btn" id="logoutViewerBtn">
                        <i class="fas fa-sign-out-alt"></i> Keluar
                    </button>
                </div>
            </div>
            
            <div class="viewer-info">
                <div>
                    <strong>Total Peserta:</strong> <span id="totalPesertaViewer">0</span> | 
                    <strong>Update Real-time:</strong> <span id="updateStatus">Aktif</span>
                </div>
                <div class="connection-status" id="viewerConnectionStatus">
                    <span class="dot"></span> <span>Terhubung</span>
                </div>
            </div>
            
            <div class="table-container">
                <table id="dataPesertaViewer">
                    <thead>
                        <tr>
                            <th width="50">Ranking</th>
                            <th width="120">Nomor Roket</th>
                            <th width="200">Nama Peserta</th>
                            <th width="250">Sekolah</th>
                            <th width="150">Daerah</th>
                            <th width="120">Peluncuran 1 (m)</th>
                            <th width="120">Peluncuran 2 (m)</th>
                            <th width="120">Skor Terbaik (m)</th>
                        </tr>
                    </thead>
                    <tbody id="pesertaTableBodyViewer">
                        <!-- Data peserta viewer akan dimuat di sini -->
                    </tbody>
                </table>
            </div>
            
            <div class="status-bar">
                <div style="font-size: 0.9rem; color: #666;">
                    <i class="fas fa-info-circle"></i> <strong>Catatan:</strong> Data ini diperbarui secara otomatis setiap 3 detik. 
                    Hanya operator yang dapat mengubah data peserta dan skor.
                </div>
            </div>
        </div>
        
        <!-- Modal Konfirmasi Reset Data -->
        <div class="modal-overlay" id="resetModal">
            <div class="modal">
                <h3><i class="fas fa-exclamation-triangle"></i> Konfirmasi Reset Data</h3>
                <p>Apakah Anda yakin ingin mereset semua data peserta? Tindakan ini akan menghapus:</p>
                <ul>
                    <li>Semua data peserta (nama, sekolah, skor)</li>
                    <li>Semua hasil peluncuran</li>
                    <li>Semua ranking yang telah dibuat</li>
                </ul>
                <p><strong>Tindakan ini tidak dapat dibatalkan!</strong></p>
                <div class="modal-buttons">
                    <button class="btn btn-danger" id="confirmResetBtn">
                        <i class="fas fa-check"></i> Ya, Reset Semua Data
                    </button>
                    <button class="btn" id="cancelResetBtn">
                        <i class="fas fa-times"></i> Batal
                    </button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Aplikasi Skoring Kompetisi Roket Air Labiaba Indonesia &copy; 2026</p>
            <p>Sistem real-time untuk operator dan viewer | Versi 1.0</p>
        </footer>
    </div>

    <script>
        // Data aplikasi
        let pesertaData = [];
        let currentPassword = "rocket2026";
        let isOperatorLoggedIn = false;
        let isViewerLoggedIn = false;
        let eventInfo = {
            tingkat: "Regional/ Nasional 2026",
            provinsi: "Jawa Tengah",
            tanggal: "2026-08-15",
            lokasi: "Gelora Bung Karno, Jakarta"
        };
        let lastUpdateTime = null;
        
        // Simulasi server untuk real-time updates
        let serverData = {
            pesertaData: [],
            eventInfo: {},
            lastUpdate: null
        };
        
        // Inisialisasi data
        function initAppData() {
            // Load data dari localStorage
            const savedPesertaData = localStorage.getItem('pesertaData');
            const savedPassword = localStorage.getItem('appPassword');
            const savedEventInfo = localStorage.getItem('eventInfo');
            
            // Inisialisasi peserta data
            if (!savedPesertaData || JSON.parse(savedPesertaData).length === 0) {
                pesertaData = [
                    { 
                        id: 1, 
                        nomorRoket: "RKT-001", 
                        nama: "Ahmad Santoso", 
                        sekolah: "SMA Negeri 1 Jakarta", 
                        daerah: "Jakarta", 
                        peluncuran1: "2.60", 
                        peluncuran2: "1.83", 
                        skorTerbaik: "1.83",
                        ranking: 2
                    },
                    { 
                        id: 2, 
                        nomorRoket: "RKT-002", 
                        nama: "Budi Prasetyo", 
                        sekolah: "SMA Negeri 2 Semarang", 
                        daerah: "Jawa Tengah", 
                        peluncuran1: "0.45", 
                        peluncuran2: "1.75", 
                        skorTerbaik: "0.45",
                        ranking: 1
                    },
                    { 
                        id: 3, 
                        nomorRoket: "RKT-003", 
                        nama: "Citra Lestari", 
                        sekolah: "SMA Negeri 3 Bandung", 
                        daerah: "Jawa Barat", 
                        peluncuran1: "3.20", 
                        peluncuran2: "2.90", 
                        skorTerbaik: "2.90",
                        ranking: 3
                    },
                    { 
                        id: 4, 
                        nomorRoket: "RKT-004", 
                        nama: "Dewi Anggraini", 
                        sekolah: "SMA Negeri 1 Surabaya", 
                        daerah: "Jawa Timur", 
                        peluncuran1: "", 
                        peluncuran2: "", 
                        skorTerbaik: "",
                        ranking: 4
                    }
                ];
                saveDataToStorage();
            } else {
                pesertaData = JSON.parse(savedPesertaData);
            }
            
            // Inisialisasi password
            if (savedPassword) {
                currentPassword = savedPassword;
            } else {
                localStorage.setItem('appPassword', currentPassword);
            }
            
            // Inisialisasi event info
            if (savedEventInfo) {
                eventInfo = JSON.parse(savedEventInfo);
            } else {
                localStorage.setItem('eventInfo', JSON.stringify(eventInfo));
            }
            
            // Update header dengan informasi event
            updateHeaderInfo();
        }
        
        // Update header dengan informasi event
        function updateHeaderInfo() {
            const headerInfo = document.getElementById('headerInfo');
            if (!headerInfo) return;
            
            headerInfo.innerHTML = `
                <div class="info-item">
                    <div class="info-label">Tingkat Kompetisi</div>
                    <div class="info-value" id="headerTingkat">${eventInfo.tingkat}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Daerah / Provinsi</div>
                    <div class="info-value" id="headerProvinsi">${eventInfo.provinsi}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Tanggal Pelaksanaan</div>
                    <div class="info-value" id="headerTanggal">${formatDate(eventInfo.tanggal)}</div>
                </div>
                <div class="info-item">
                    <div class="info-label">Tempat Pelaksanaan</div>
                    <div class="info-value" id="headerLokasi">${eventInfo.lokasi}</div>
                </div>
            `;
        }
        
        // Format tanggal untuk tampilan
        function formatDate(dateString) {
            if (!dateString) return "-";
            const date = new Date(dateString);
            return date.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: 'long',
                year: 'numeric'
            });
        }
        
        // Simpan data ke localStorage dan update server
        function saveDataToStorage() {
            localStorage.setItem('pesertaData', JSON.stringify(pesertaData));
            localStorage.setItem('eventInfo', JSON.stringify(eventInfo));
            
            // Simulasikan update ke server untuk real-time
            serverData.pesertaData = [...pesertaData];
            serverData.eventInfo = {...eventInfo};
            serverData.lastUpdate = new Date().toISOString();
            
            updateLastUpdateTime();
            
            // Update data di panel viewer jika sedang login
            if (isViewerLoggedIn) {
                updateViewerTable();
            }
        }
        
        // Update waktu terakhir perubahan
        function updateLastUpdateTime() {
            const now = new Date();
            const formattedTime = now.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            if (document.getElementById('lastUpdate')) {
                document.getElementById('lastUpdate').textContent = formattedTime;
            }
            
            lastUpdateTime = now;
            
            // Update status untuk viewer
            if (isViewerLoggedIn && document.getElementById('updateStatus')) {
                document.getElementById('updateStatus').textContent = formattedTime;
            }
        }
        
        // Hitung skor terbaik
        function hitungSkorTerbaik(peluncuran1, peluncuran2) {
            if (peluncuran1 === "" && peluncuran2 === "") return "";
            if (peluncuran1 === "") return parseFloat(peluncuran2);
            if (peluncuran2 === "") return parseFloat(peluncuran1);
            
            // Ambil nilai terkecil (mendekati target)
            return Math.min(parseFloat(peluncuran1), parseFloat(peluncuran2));
        }
        
        // Hitung ulang ranking berdasarkan skor terbaik
        function hitungRanking() {
            // Filter peserta yang memiliki skor terbaik
            const pesertaDenganSkor = pesertaData.filter(p => p.skorTerbaik !== "");
            
            // Urutkan berdasarkan skor terbaik (nilai terkecil adalah terbaik)
            pesertaDenganSkor.sort((a, b) => {
                return parseFloat(a.skorTerbaik) - parseFloat(b.skorTerbaik);
            });
            
            // Tetapkan ranking
            let currentRank = 1;
            let previousScore = null;
            let skipRank = 0;
            
            for (let i = 0; i < pesertaDenganSkor.length; i++) {
                const peserta = pesertaDenganSkor[i];
                
                if (previousScore !== null && peserta.skorTerbaik === previousScore) {
                    // Jika skor sama dengan peserta sebelumnya, beri ranking yang sama
                    peserta.ranking = currentRank - 1;
                    skipRank++;
                } else {
                    // Jika skor berbeda, beri ranking baru
                    peserta.ranking = currentRank + skipRank;
                    currentRank = currentRank + skipRank + 1;
                    skipRank = 0;
                }
                
                previousScore = peserta.skorTerbaik;
                
                // Update data di array utama
                const index = pesertaData.findIndex(p => p.id === peserta.id);
                pesertaData[index].ranking = peserta.ranking;
            }
            
            // Untuk peserta tanpa skor, beri ranking berdasarkan urutan
            const pesertaTanpaSkor = pesertaData.filter(p => p.skorTerbaik === "");
            let rankingTanpaSkor = pesertaDenganSkor.length > 0 ? 
                Math.max(...pesertaDenganSkor.map(p => p.ranking)) + 1 : 1;
                
            for (const peserta of pesertaTanpaSkor) {
                const index = pesertaData.findIndex(p => p.id === peserta.id);
                pesertaData[index].ranking = rankingTanpaSkor++;
            }
            
            // Urutkan pesertaData berdasarkan ranking
            pesertaData.sort((a, b) => {
                // Jika ranking sama, urutkan berdasarkan ID
                if (a.ranking === b.ranking) {
                    return a.id - b.id;
                }
                return a.ranking - b.ranking;
            });
        }
        
        // Update tabel operator
        function updateOperatorTable() {
            const tableBody = document.getElementById('pesertaTableBody');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            hitungRanking();
            
            pesertaData.forEach((peserta, index) => {
                const row = document.createElement('tr');
                
                // Tambah kelas untuk 50 peserta teratas
                if (index < 50) {
                    row.classList.add('top-50');
                }
                
                // Tambah kelas khusus untuk ranking 1, 2, 3
                if (peserta.ranking === 1) {
                    row.classList.add('ranking-1');
                } else if (peserta.ranking === 2) {
                    row.classList.add('ranking-2');
                } else if (peserta.ranking === 3) {
                    row.classList.add('ranking-3');
                }
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${peserta.nomorRoket}</td>
                    <td>${peserta.nama}</td>
                    <td>${peserta.sekolah}</td>
                    <td>${peserta.daerah}</td>
                    <td><input type="number" step="0.01" min="0" class="score-input" data-id="${peserta.id}" data-type="peluncuran1" value="${peserta.peluncuran1}"></td>
                    <td><input type="number" step="0.01" min="0" class="score-input" data-id="${peserta.id}" data-type="peluncuran2" value="${peserta.peluncuran2}"></td>
                    <td>${peserta.skorTerbaik}</td>
                    <td>${peserta.ranking}</td>
                    <td><button class="btn btn-danger btn-sm hapus-peserta" data-id="${peserta.id}"><i class="fas fa-trash"></i> Hapus</button></td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Update total peserta
            if (document.getElementById('totalPeserta')) {
                document.getElementById('totalPeserta').textContent = pesertaData.length;
            }
            
            if (document.getElementById('infoPesertaCount')) {
                document.getElementById('infoPesertaCount').textContent = pesertaData.length;
            }
            
            // Tambah event listener untuk input skor
            document.querySelectorAll('.score-input').forEach(input => {
                input.addEventListener('change', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    const type = this.getAttribute('data-type');
                    const value = this.value;
                    
                    updateSkorPeserta(id, type, value);
                });
            });
            
            // Tambah event listener untuk tombol hapus
            document.querySelectorAll('.hapus-peserta').forEach(button => {
                button.addEventListener('click', function() {
                    const id = parseInt(this.getAttribute('data-id'));
                    hapusPeserta(id);
                });
            });
            
            saveDataToStorage();
        }
        
        // Update tabel viewer
        function updateViewerTable() {
            const tableBody = document.getElementById('pesertaTableBodyViewer');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            // Urutkan berdasarkan ranking
            const pesertaSorted = [...pesertaData].sort((a, b) => {
                if (a.ranking === b.ranking) {
                    return a.id - b.id;
                }
                return a.ranking - b.ranking;
            });
            
            pesertaSorted.forEach((peserta, index) => {
                const row = document.createElement('tr');
                
                // Tambah kelas untuk 50 peserta teratas
                if (index < 50) {
                    row.classList.add('top-50');
                }
                
                // Tambah kelas khusus untuk ranking 1, 2, 3
                if (peserta.ranking === 1) {
                    row.classList.add('ranking-1');
                } else if (peserta.ranking === 2) {
                    row.classList.add('ranking-2');
                } else if (peserta.ranking === 3) {
                    row.classList.add('ranking-3');
                }
                
                row.innerHTML = `
                    <td>${peserta.ranking}</td>
                    <td>${peserta.nomorRoket}</td>
                    <td>${peserta.nama}</td>
                    <td>${peserta.sekolah}</td>
                    <td>${peserta.daerah}</td>
                    <td>${peserta.peluncuran1 || ''}</td>
                    <td>${peserta.peluncuran2 || ''}</td>
                    <td>${peserta.skorTerbaik || ''}</td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Update total peserta
            if (document.getElementById('totalPesertaViewer')) {
                document.getElementById('totalPesertaViewer').textContent = pesertaData.length;
            }
        }
        
        // Update skor peserta
        function updateSkorPeserta(id, type, value) {
            const index = pesertaData.findIndex(p => p.id === id);
            if (index === -1) return;
            
            if (type === 'peluncuran1') {
                pesertaData[index].peluncuran1 = value;
                
                // Hitung skor terbaik jika peluncuran1 diisi
                if (value !== "") {
                    pesertaData[index].skorTerbaik = hitungSkorTerbaik(value, pesertaData[index].peluncuran2);
                } else {
                    // Jika peluncuran1 dikosongkan, hitung ulang skor terbaik
                    pesertaData[index].skorTerbaik = hitungSkorTerbaik("", pesertaData[index].peluncuran2);
                }
            } else if (type === 'peluncuran2') {
                pesertaData[index].peluncuran2 = value;
                
                // Hitung skor terbaik jika peluncuran2 diisi
                if (value !== "") {
                    pesertaData[index].skorTerbaik = hitungSkorTerbaik(pesertaData[index].peluncuran1, value);
                } else {
                    // Jika peluncuran2 dikosongkan, hitung ulang skor terbaik
                    pesertaData[index].skorTerbaik = hitungSkorTerbaik(pesertaData[index].peluncuran1, "");
                }
            }
            
            updateOperatorTable();
        }
        
        // Tambah peserta baru
        function tambahPeserta() {
            const nama = document.getElementById('namaPeserta').value.trim();
            const nomorRoket = document.getElementById('nomorRoket').value.trim();
            const sekolah = document.getElementById('asalSekolah').value.trim();
            const daerah = document.getElementById('daerahSekolah').value.trim();
            
            if (!nama || !nomorRoket || !sekolah || !daerah) {
                alert('Harap isi semua data peserta!');
                return;
            }
            
            // Cek apakah nomor roket sudah digunakan
            if (pesertaData.some(p => p.nomorRoket === nomorRoket)) {
                alert(`Nomor roket ${nomorRoket} sudah digunakan!`);
                return;
            }
            
            // Cek batas maksimal 500 peserta
            if (pesertaData.length >= 500) {
                alert('Maksimal 500 peserta telah tercapai!');
                return;
            }
            
            // Buat ID baru
            const newId = pesertaData.length > 0 ? Math.max(...pesertaData.map(p => p.id)) + 1 : 1;
            
            // Tambah peserta baru
            pesertaData.push({
                id: newId,
                nomorRoket: nomorRoket,
                nama: nama,
                sekolah: sekolah,
                daerah: daerah,
                peluncuran1: "",
                peluncuran2: "",
                skorTerbaik: "",
                ranking: pesertaData.length + 1
            });
            
            // Reset form
            document.getElementById('namaPeserta').value = '';
            document.getElementById('nomorRoket').value = '';
            document.getElementById('asalSekolah').value = '';
            document.getElementById('daerahSekolah').value = '';
            
            updateOperatorTable();
            alert('Peserta berhasil ditambahkan!');
        }
        
        // Hapus peserta
        function hapusPeserta(id) {
            if (confirm('Apakah Anda yakin ingin menghapus peserta ini?')) {
                pesertaData = pesertaData.filter(p => p.id !== id);
                updateOperatorTable();
            }
        }
        
        // Reset semua data
        function resetData() {
            document.getElementById('resetModal').style.display = 'flex';
        }
        
        // Konfirmasi reset data
        function confirmResetData() {
            pesertaData = [];
            saveDataToStorage();
            updateOperatorTable();
            document.getElementById('resetModal').style.display = 'none';
            alert('Semua data telah direset.');
        }
        
        // Ganti password
        function gantiPassword() {
            const currentPass = document.getElementById('currentPassword').value;
            const newPass = document.getElementById('newPassword').value;
            const confirmPass = document.getElementById('confirmPassword').value;
            
            if (currentPass !== currentPassword) {
                alert('Password saat ini salah!');
                return;
            }
            
            if (newPass !== confirmPass) {
                alert('Password baru dan konfirmasi password tidak cocok!');
                return;
            }
            
            if (newPass.length < 6) {
                alert('Password baru harus minimal 6 karakter!');
                return;
            }
            
            currentPassword = newPass;
            localStorage.setItem('appPassword', newPass);
            
            // Reset form password
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
            
            alert('Password berhasil diubah!');
        }
        
        // Export ke Excel
        function exportToExcel() {
            alert('Fitur export ke Excel akan mengunduh file data_peserta.xlsx');
            
            // Simulasi: buat data CSV
            let csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "No,Roket,Nama Peserta,Sekolah,Daerah,Peluncuran 1,Peluncuran 2,Skor Terbaik,Ranking\n";
            
            pesertaData.forEach((peserta, index) => {
                csvContent += `${index + 1},${peserta.nomorRoket},${peserta.nama},${peserta.sekolah},${peserta.daerah},${peserta.peluncuran1},${peserta.peluncuran2},${peserta.skorTerbaik},${peserta.ranking}\n`;
            });
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "data_peserta_roket_air.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // Export ke PDF
        function exportToPDF() {
            alert('Fitur export ke PDF akan mengunduh file hasil_kompetisi.pdf');
            // Dalam implementasi nyata, ini akan menggunakan library seperti jsPDF
        }
        
        // Upload data dari Excel (simulasi)
        function uploadExcelData() {
            const fileInput = document.getElementById('excelFile');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Pilih file Excel terlebih dahulu!');
                return;
            }
            
            // Dalam implementasi nyata, ini akan membaca file Excel
            // Untuk contoh, kita akan tambah data dummy
            const dummyData = [
                { nomorRoket: "RKT-101", nama: "Rina Sari", sekolah: "SMA Negeri 1 Yogyakarta", daerah: "DIY" },
                { nomorRoket: "RKT-102", nama: "Eko Wijaya", sekolah: "SMA Negeri 1 Solo", daerah: "Jawa Tengah" },
                { nomorRoket: "RKT-103", nama: "Sari Dewi", sekolah: "SMA Negeri 1 Malang", daerah: "Jawa Timur" }
            ];
            
            let addedCount = 0;
            dummyData.forEach(data => {
                // Cek apakah nomor roket sudah digunakan
                if (!pesertaData.some(p => p.nomorRoket === data.nomorRoket) && pesertaData.length < 500) {
                    const newId = pesertaData.length > 0 ? Math.max(...pesertaData.map(p => p.id)) + 1 : 1;
                    
                    pesertaData.push({
                        id: newId,
                        nomorRoket: data.nomorRoket,
                        nama: data.nama,
                        sekolah: data.sekolah,
                        daerah: data.daerah,
                        peluncuran1: "",
                        peluncuran2: "",
                        skorTerbaik: "",
                        ranking: pesertaData.length + 1
                    });
                    
                    addedCount++;
                }
            });
            
            fileInput.value = '';
            updateOperatorTable();
            alert(`${addedCount} data peserta berhasil ditambahkan dari file Excel!`);
        }
        
        // Download template Excel (simulasi)
        function downloadTemplate() {
            alert('Template Excel akan diunduh');
            // Dalam implementasi nyata, ini akan mengunduh file template
        }
        
        // Update informasi event
        function updateEventInfo() {
            eventInfo.tingkat = document.getElementById('tingkat').value;
            eventInfo.provinsi = document.getElementById('provinsi').value;
            eventInfo.tanggal = document.getElementById('tanggal').value;
            eventInfo.lokasi = document.getElementById('lokasi').value;
            
            saveDataToStorage();
            updateHeaderInfo();
            
            alert('Informasi event berhasil diperbarui!');
        }
        
        // Tampilkan/sembunyikan pengaturan
        function toggleSettings() {
            const settingsSection = document.getElementById('settingsSection');
            const showBtn = document.getElementById('showSettingsBtn');
            const hideBtn = document.getElementById('hideSettingsBtn');
            
            if (settingsSection.style.display === 'none' || settingsSection.style.display === '') {
                settingsSection.style.display = 'block';
                showBtn.style.display = 'none';
                hideBtn.style.display = 'block';
            } else {
                settingsSection.style.display = 'none';
                showBtn.style.display = 'block';
                hideBtn.style.display = 'none';
            }
        }
        
        // Tampilkan/sembunyikan konfigurasi event
        function toggleEventConfig() {
            const eventConfigSection = document.getElementById('eventConfigSection');
            if (eventConfigSection.style.display === 'none' || eventConfigSection.style.display === '') {
                eventConfigSection.style.display = 'block';
            } else {
                eventConfigSection.style.display = 'none';
            }
        }
        
        // Simulasi real-time update untuk viewer
        function simulateRealTimeUpdate() {
            if (isViewerLoggedIn) {
                // Cek apakah ada perubahan data di server
                const serverLastUpdate = serverData.lastUpdate;
                const currentData = JSON.stringify(pesertaData);
                const serverDataStr = JSON.stringify(serverData.pesertaData);
                
                if (currentData !== serverDataStr) {
                    // Update data dari server
                    pesertaData = [...serverData.pesertaData];
                    eventInfo = {...serverData.eventInfo};
                    updateViewerTable();
                    updateHeaderInfo();
                    
                    // Update status koneksi
                    const connectionStatus = document.getElementById('viewerConnectionStatus');
                    if (connectionStatus) {
                        connectionStatus.innerHTML = '<span class="dot"></span> <span>Update diterima: ' + new Date().toLocaleTimeString('id-ID') + '</span>';
                    }
                }
            }
        }
        
        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Inisialisasi data
            initAppData();
            updateLastUpdateTime();
            
            // Login sebagai operator (tampilkan form password)
            document.getElementById('operatorLoginBtn').addEventListener('click', function() {
                document.getElementById('passwordSection').style.display = 'block';
            });
            
            // Kembali ke pilihan login
            document.getElementById('backToLoginBtn').addEventListener('click', function() {
                document.getElementById('passwordSection').style.display = 'none';
            });
            
            // Submit password operator
            document.getElementById('submitPasswordBtn').addEventListener('click', function() {
                const password = document.getElementById('password').value;
                
                if (password === currentPassword) {
                    isOperatorLoggedIn = true;
                    document.getElementById('loginSection').style.display = 'none';
                    document.getElementById('operatorPanel').style.display = 'block';
                    document.getElementById('password').value = '';
                    document.getElementById('passwordSection').style.display = 'none';
                    
                    // Isi form konfigurasi event dengan data yang ada
                    document.getElementById('tingkat').value = eventInfo.tingkat;
                    document.getElementById('provinsi').value = eventInfo.provinsi;
                    document.getElementById('tanggal').value = eventInfo.tanggal;
                    document.getElementById('lokasi').value = eventInfo.lokasi;
                    
                    updateOperatorTable();
                } else {
                    alert('Password salah!');
                }
            });
            
            // Login sebagai viewer (langsung masuk)
            document.getElementById('viewerLoginBtn').addEventListener('click', function() {
                isViewerLoggedIn = true;
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('viewerPanel').style.display = 'block';
                updateViewerTable();
                
                // Set interval untuk update real-time setiap 3 detik
                setInterval(simulateRealTimeUpdate, 3000);
            });
            
            // Logout operator
            document.getElementById('logoutOperatorBtn').addEventListener('click', function() {
                isOperatorLoggedIn = false;
                document.getElementById('operatorPanel').style.display = 'none';
                document.getElementById('loginSection').style.display = 'flex';
                // Sembunyikan pengaturan saat logout
                document.getElementById('settingsSection').style.display = 'none';
                document.getElementById('showSettingsBtn').style.display = 'block';
                document.getElementById('hideSettingsBtn').style.display = 'none';
                document.getElementById('eventConfigSection').style.display = 'block';
            });
            
            // Logout viewer
            document.getElementById('logoutViewerBtn').addEventListener('click', function() {
                isViewerLoggedIn = false;
                document.getElementById('viewerPanel').style.display = 'none';
                document.getElementById('loginSection').style.display = 'flex';
            });
            
            // Tombol pengaturan
            document.getElementById('settingsBtn').addEventListener('click', function() {
                toggleSettings();
            });
            
            // Tombol konfigurasi event
            document.getElementById('eventConfigBtn').addEventListener('click', function() {
                toggleEventConfig();
            });
            
            // Tombol tampilkan pengaturan
            document.getElementById('showSettingsBtn').addEventListener('click', toggleSettings);
            
            // Tombol sembunyikan pengaturan
            document.getElementById('hideSettingsBtn').addEventListener('click', toggleSettings);
            
            // Tambah peserta
            document.getElementById('tambahPesertaBtn').addEventListener('click', tambahPeserta);
            
            // Upload Excel
            document.getElementById('uploadExcelBtn').addEventListener('click', uploadExcelData);
            
            // Download template
            document.getElementById('downloadTemplate').addEventListener('click', function(e) {
                e.preventDefault();
                downloadTemplate();
            });
            
            // Reset data
            document.getElementById('resetDataBtn').addEventListener('click', resetData);
            
            // Konfirmasi reset data
            document.getElementById('confirmResetBtn').addEventListener('click', confirmResetData);
            
            // Batal reset data
            document.getElementById('cancelResetBtn').addEventListener('click', function() {
                document.getElementById('resetModal').style.display = 'none';
            });
            
            // Update event info
            document.getElementById('updateEventBtn').addEventListener('click', updateEventInfo);
            
            // Simpan password baru
            document.getElementById('savePasswordBtn').addEventListener('click', gantiPassword);
            
            // Batal ganti password
            document.getElementById('cancelPasswordBtn').addEventListener('click', function() {
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
            });
            
            // Export ke Excel
            document.getElementById('exportExcelBtn').addEventListener('click', exportToExcel);
            
            // Export ke PDF
            document.getElementById('exportPDFBtn').addEventListener('click', exportToPDF);
            
            // Update waktu setiap menit untuk viewer
            setInterval(() => {
                if (isViewerLoggedIn) {
                    const now = new Date();
                    document.getElementById('updateStatus').textContent = now.toLocaleTimeString('id-ID');
                }
            }, 60000);
        });
    </script>
</body>
</html>